
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ZacharyBork.github.io/NectarGAN/api/losses/lossmanager/">
      
      
        <link rel="prev" href="../../models/patchgan/">
      
      
        <link rel="next" href="../loss_spec/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>LossManager - NectarGAN</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nectargan-api-lossmanager" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="NectarGAN" class="md-header__button md-logo" aria-label="NectarGAN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NectarGAN
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              LossManager
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ZacharyBork/NectarGAN" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="NectarGAN" class="md-nav__button md-logo" aria-label="NectarGAN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NectarGAN
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ZacharyBork/NectarGAN" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install / Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing_your_installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing Your Installation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Toolbox
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Toolbox
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Quickstart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/toolbox_training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pt. 1 - Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/toolbox_testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pt. 2 - Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/toolbox_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pt. 3 - Review
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sections
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Sections
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/experiment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Review
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Trainers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Trainers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trainers/trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trainer Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trainers/building_a_trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building a Trainer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5_1" >
        
          
          <label class="md-nav__link" for="__nav_4_5_1" id="__nav_4_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UNet
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5_1">
            <span class="md-nav__icon md-icon"></span>
            UNet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/unet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/unet_blocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blocks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/patchgan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PatchGAN
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" checked>
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Losses
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Losses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    LossManager
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    LossManager
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-loss-manager-is-one-of-the-core-features-of-the-nectargan-api-it-is-a-drop-in-solution-for-managing-tracking-and-logging-everything-related-to-loss-in-your-model" class="md-nav__link">
    <span class="md-ellipsis">
      The loss manager is one of the core features of the NectarGAN API. It is a drop-in solution for managing, tracking, and logging everything related to loss in your model.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The loss manager is one of the core features of the NectarGAN API. It is a drop-in solution for managing, tracking, and logging everything related to loss in your model.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-nectarganlossesloss_managerlossmanager" class="md-nav__link">
    <span class="md-ellipsis">
      Source: nectargan.losses.loss_manager.LossManager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lossmanager-dataclasses" class="md-nav__link">
    <span class="md-ellipsis">
      LossManager Dataclasses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LossManager Dataclasses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nectarganlosseslm_datalmhistory" class="md-nav__link">
    <span class="md-ellipsis">
      1. nectargan.losses.lm_data.LMHistory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nectarganlosseslm_datalmloss" class="md-nav__link">
    <span class="md-ellipsis">
      2. nectargan.losses.lm_data.LMLoss
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-lossmanager" class="md-nav__link">
    <span class="md-ellipsis">
      Using the LossManager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-registered-loss-data" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Registered Loss Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Querying Registered Loss Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-relating-to-losses-registered-with-a-given-lossmanager-instance-can-be-retrived-in-a-variety-of-ways-dependent-upon-exactly-what-data-you-are-trying-to-query-and-what-format-you-would-like-it-returned-in" class="md-nav__link">
    <span class="md-ellipsis">
      Data relating to losses registered with a given LossManager instance can be retrived in a variety of ways, dependent upon exactly what data you are trying to query, and what format you would like it returned in.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-lmloss-objects-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Querying LMLoss Objects Directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-loss-values-as-a-dict" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Loss Values (as a dict)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-loss-values-as-a-tensor" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Loss Values (as a tensor)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-loss-weights" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Loss Weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-tags-to-query-registered-losses" class="md-nav__link">
    <span class="md-ellipsis">
      Using Tags to Query Registered Losses
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dumping-cached-values-to-loss-log" class="md-nav__link">
    <span class="md-ellipsis">
      Dumping Cached Values to Loss Log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-specs" class="md-nav__link">
    <span class="md-ellipsis">
      Loss Specs?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Loss Specs?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#see-here-for-more-information-on-loss-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      See here for more information on loss specifications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convenience-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Convenience Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Convenience Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-lossmanager-includes-two-convenience-functions-for-printing-debug-values-to-the-console-during-training-these-are" class="md-nav__link">
    <span class="md-ellipsis">
      The LossManager includes two convenience functions for printing debug values to the console during training. These are:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lossmanagerprint_losses" class="md-nav__link">
    <span class="md-ellipsis">
      LossManager.print_losses()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lossmanagerprint_weights" class="md-nav__link">
    <span class="md-ellipsis">
      LossManager.print_weights()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../loss_spec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loss Specs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../loss_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loss Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Scheduling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Scheduling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/schedulers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedulers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/schedule_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/schedule_dataclass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule Dataclass
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/integrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onnx_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ONNX Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visdom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visdom
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scripts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Links
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Links
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/ZacharyBork/NectarGAN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/ZacharyBork/NectarGAN/releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/CONTRIBUTING.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-loss-manager-is-one-of-the-core-features-of-the-nectargan-api-it-is-a-drop-in-solution-for-managing-tracking-and-logging-everything-related-to-loss-in-your-model" class="md-nav__link">
    <span class="md-ellipsis">
      The loss manager is one of the core features of the NectarGAN API. It is a drop-in solution for managing, tracking, and logging everything related to loss in your model.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The loss manager is one of the core features of the NectarGAN API. It is a drop-in solution for managing, tracking, and logging everything related to loss in your model.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-nectarganlossesloss_managerlossmanager" class="md-nav__link">
    <span class="md-ellipsis">
      Source: nectargan.losses.loss_manager.LossManager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lossmanager-dataclasses" class="md-nav__link">
    <span class="md-ellipsis">
      LossManager Dataclasses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LossManager Dataclasses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nectarganlosseslm_datalmhistory" class="md-nav__link">
    <span class="md-ellipsis">
      1. nectargan.losses.lm_data.LMHistory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nectarganlosseslm_datalmloss" class="md-nav__link">
    <span class="md-ellipsis">
      2. nectargan.losses.lm_data.LMLoss
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-lossmanager" class="md-nav__link">
    <span class="md-ellipsis">
      Using the LossManager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-registered-loss-data" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Registered Loss Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Querying Registered Loss Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-relating-to-losses-registered-with-a-given-lossmanager-instance-can-be-retrived-in-a-variety-of-ways-dependent-upon-exactly-what-data-you-are-trying-to-query-and-what-format-you-would-like-it-returned-in" class="md-nav__link">
    <span class="md-ellipsis">
      Data relating to losses registered with a given LossManager instance can be retrived in a variety of ways, dependent upon exactly what data you are trying to query, and what format you would like it returned in.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-lmloss-objects-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Querying LMLoss Objects Directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-loss-values-as-a-dict" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Loss Values (as a dict)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-loss-values-as-a-tensor" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Loss Values (as a tensor)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-loss-weights" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Loss Weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-tags-to-query-registered-losses" class="md-nav__link">
    <span class="md-ellipsis">
      Using Tags to Query Registered Losses
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dumping-cached-values-to-loss-log" class="md-nav__link">
    <span class="md-ellipsis">
      Dumping Cached Values to Loss Log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-specs" class="md-nav__link">
    <span class="md-ellipsis">
      Loss Specs?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Loss Specs?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#see-here-for-more-information-on-loss-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      See here for more information on loss specifications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convenience-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Convenience Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Convenience Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-lossmanager-includes-two-convenience-functions-for-printing-debug-values-to-the-console-during-training-these-are" class="md-nav__link">
    <span class="md-ellipsis">
      The LossManager includes two convenience functions for printing debug values to the console during training. These are:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lossmanagerprint_losses" class="md-nav__link">
    <span class="md-ellipsis">
      LossManager.print_losses()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lossmanagerprint_weights" class="md-nav__link">
    <span class="md-ellipsis">
      LossManager.print_weights()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="nectargan-api-lossmanager">NectarGAN API - LossManager</h1>
<blockquote>
<p><a href="../../"><em><code>NectarGAN API - Home</code></em></a></p>
</blockquote>
<h4 id="the-loss-manager-is-one-of-the-core-features-of-the-nectargan-api-it-is-a-drop-in-solution-for-managing-tracking-and-logging-everything-related-to-loss-in-your-model">The loss manager is one of the core features of the NectarGAN API. It is a drop-in solution for managing, tracking, and logging everything related to loss in your model.</h4>
<h5 id="source-nectarganlossesloss_managerlossmanager">Source: <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/losses/loss_manager.py">nectargan.losses.loss_manager.LossManager</a></h5>
<h3 id="key-features">Key Features</h3>
<ul>
<li><strong>Builds an easy to use wrapper around around any loss function,</strong> allowing you to evaluate loss functions in your training script in a way which is as easy as calling loss functions traditionally, but which dramatically expands the backend functionality of any loss function registered with the <code>LossManager</code>.</li>
<li><strong>Caches loss function results in multiple formats</strong> with easy to use mechanisms for recalling the values during training.</li>
<li><strong>An intelligent cache management system</strong> allows mean loss values to be cached to memory, and dumped to a JSON log at your discretion, or automatically if a configurable cache limit is reached.</li>
<li><strong>Quickly initialize a configurable objective function with a pre-built loss spec,</strong> or register your own loss functions with the <code>LossManager</code> to build your own model objective from scratch, while still being able to use all the QOL features that the LossManager offers. You can even define your own reusable loss specs to feed to the <code>LossManager</code>, and it will take care of the rest. </li>
</ul>
<h2 id="lossmanager-dataclasses">LossManager Dataclasses</h2>
<p>To understand how the <code>LossManager</code> functions, and how it manages the data for the losses that are registered with it, we first have to take a quick look at two dataclasses which are at the core of it's functionality. These are:</p>
<h3 id="1-nectarganlosseslm_datalmhistory">1. <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/losses/lm_data.py#L8"><code>nectargan.losses.lm_data.LMHistory</code></a></h3>
<p><strong>Starting with the simpler of the two dataclasses, <code>LMHistory</code> only has one job:</strong> <strong><em>store previous loss value history.</em></strong></p>
<p>Every loss function registered with a <code>LossManager</code> instance has an <code>LMHistory</code> instance assigned to it in a way which will be explained momentarily. An <code>LMHistory</code> instance contains just two lists, they are dual-purpose, however. If loss logging is enabled, i.e. <code>LossManager(enable_logging=True)</code>, these two lists will be used to store the mean value of the loss result tensor and the current weight value of the loss, both as 32bit floating point values, every time the parent loss function is called via <code>LossManager.compute_loss_xy()</code>.</p>
<p>If logging is disabled, however, each time <code>LossManager.compute_loss_xy()</code> is called for a given loss, both lists in that loss's <code>LMHistory</code> are cleared, after which time the new values are appending to each list. In practice, this means that if <code>enable_logging=False</code> each list will only store a single value, the most recent loss mean and weight respectively, at any given time.</p>
<h3 id="2-nectarganlosseslm_datalmloss">2. <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/losses/lm_data.py#L26"><code>nectargan.losses.lm_data.LMLoss</code></a></h3>
<p><strong><em>This dataclass is responsible for storing all information about a registered loss.</em></strong> For every loss function that is registered with a <code>LossManager</code> instance via <code>LossManager.register_loss_fn()</code>, an <code>LMLoss</code> instance is created which describes the loss function. A full description of the values contained with an <code>LMLoss</code> instance can be seen by clicking on the above link, but here is a rough outline:</p>
<ul>
<li><code>name</code>: a string, unique to this registered loss, which is used for lookup by various <code>LossManager</code> functions.</li>
<li><code>function</code>: a reference to the <code>torch.nn.Module</code> for the loss function. This can be almost any <code>Module</code> as long as it has a forward function that returns a tensor. One caveat is that, currently, loss functions registered with the <code>LossManager</code> can only accept two input tensors for loss computation (<code>y</code>, <code>y_fake</code>), although I do plan to expand that at some point in the future.</li>
<li><code>loss_weight</code>: The weight value (lambda) to apply to the resulting loss tensor when it is called, before the tensor is returned by <code>LossManager.compute_loss_xy()</code>.</li>
<li><code>schedule</code>: A <a href="../../scheduling/"><code>Schedule</code></a> object defining a weight schedule for the given loss. If no <code>Schedule</code> is provided when the LMLoss is initialized, the provided <code>loss_weight</code> will be used for the duration of training.</li>
<li><code>last_loss_map</code>: This is not set when initializing an <code>LMLoss</code> object. It is instead initialized as a dummy tensor, and then used by the <code>LossManager</code> each time the parent loss function is run to store a detached version of the resulting loss tensor so they can be recalled for visualization.
store history.</li>
<li><code>history</code>: This is also not set at init-time. A unique <code>LMHistory</code> object is automatically created and assigned to every loss registered with the loss manager.</li>
<li><code>tags</code>: An optional list of strings containing identifier tags which can be used to search for and filter registered losses in various <code>LossManager</code> functions.</li>
</ul>
<h2 id="using-the-lossmanager">Using the LossManager</h2>
<p>Initializing a new <code>LossManager</code> instance:</p>
<pre><code class="language-python">from nectargan.config.config_manager import ConfigManager
from nectargan.losses.loss_manager import LossManager

config_manager = ConfigManager('path/to/config.json')
loss_manager = LossManager(
    config=config_manager.data,
    experiment_dir='/path/to/experiment/output/directory')
</code></pre>
<p>Register a new loss function with a <code>LossManager</code> instance:</p>
<pre><code class="language-python">import torch.nn as nn
L1 = nn.L1Loss().to(config_manager.data.common.device)

loss_manager.register_loss_fn(
    loss_name='mylossfunction',
    loss_fn=L1,
    loss_weight=100.0,
    tags=['descriptive_lookup_tag'])
</code></pre>
<blockquote>
<p>[!WARNING]
The <code>loss_name</code> you assign to your loss function when you register it must be unique amongst all other loss functions registered with that <code>LossManager</code> instance. If you attempt to register a loss function with a name that is already registered, the <code>LossManager</code> will raise an exception.</p>
</blockquote>
<p>Running your loss function via the loss manager will return the result of the given loss function's <code>forward()</code> function as a <code>torch.Tensor</code>. The Tensor that is return has had weights pre-applied by <code>LossManager.compute_loss_xy() -&gt; LossManager._weight_loss()</code>, based on whatever the current weight value of the registered loss is:</p>
<pre><code class="language-python">import torch

y = torch.Tensor()      # Ground truth
y_fake = torch.Tensor() # Generator output 

result: torch.Tensor = loss_manager.compute_loss_xy(loss_name='mylossfunction', x=y_fake, y=y)
</code></pre>
<h2 id="querying-registered-loss-data">Querying Registered Loss Data</h2>
<h4 id="data-relating-to-losses-registered-with-a-given-lossmanager-instance-can-be-retrived-in-a-variety-of-ways-dependent-upon-exactly-what-data-you-are-trying-to-query-and-what-format-you-would-like-it-returned-in">Data relating to losses registered with a given <code>LossManager</code> instance can be retrived in a variety of ways, dependent upon exactly what data you are trying to query, and what format you would like it returned in.</h4>
<h3 id="querying-lmloss-objects-directly">Querying LMLoss Objects Directly</h3>
<p>The most flexible method is to just query the raw <code>LMLoss</code> objects directly. This can be done as follows:</p>
<pre><code class="language-python">losses: dict[str, LMLoss] = loss_manager.get_registered_losses(query=None)
</code></pre>
<p>This will return all registered loss functions as a dict. The key for each loss will be the name it was registered with. So for our above example, we could then query any info related to our <code>mylossfunction</code> function like this:</p>
<pre><code class="language-python">mylossfn: LMLoss = losses['mylossfunction'] # Query the LMLoss object
lossfn = mylossfn.function                  # Get the loss function module
loss_map = mylossfn.last_lost_map           # Get the most recent loss result as a torch.Tensor
</code></pre>
<blockquote>
<p>[!NOTE]
There is one thing to be aware of when querying the <code>LMLoss</code> objects directly like this. Were you to do this, expecting to get the loss value and weights history lists:
<code>python
values : dict[str, float] = mylossfn.history.losses
weights: dict[str, float] = mylossfn.history.weights</code>
You would find that <code>weights</code> and <code>values</code> are empty lists. <strong>This is intentional</strong>. <code>LossManager.get_registered_losses()</code> has an optional flag called <code>strip</code> which defaults to <code>True</code>. If this flag is not overridden with a value <code>Dalse</code>, the losses <code>history.values</code> and <code>history.weights</code> lists are cleared. </p>
<p>The reasoning behind this is that dependent upon what the <code>history_buffer_size</code> of the <code>LossManager</code> is set at, these lists can get fairly long. And if you have a significant amount of registered losses, passing them around can become a fairly heavy task, so they are stripped by default to reduce the memory overhead. If you need these values for whatever reason, though, just call <code>LossManager.get_registered_losses()</code> with <code>strip=False</code>. All that said, however, as long as the <code>LossManager</code>'s <code>history_buffer_size</code> is kept to below a reasonable value (i.e. ~100,000), the cost realistically isn't all that concerning.</p>
</blockquote>
<h3 id="querying-loss-values-as-a-dict">Querying Loss Values (as a dict)</h3>
<p>Loss values can be retrieved in dictionary form as follows:</p>
<pre><code class="language-python">values: dict[str, float] = loss_manager.get_loss_values(precision=2)
</code></pre>
<p>This will return a dictionary of floating point values with lookup keys matching the corresponding loss's name. The optional <code>precision</code> argument tells the function how many digits after the decimal point to round the returned loss values to. The default is <code>2</code> to keep things tidy if you want to print or otherwise log the values, but you can increase it if you need more precise return values.</p>
<blockquote>
<p>[!IMPORTANT]
<code>LossManager.get_loss_values()</code> uses the last value stored in <code>LossManager.history</code> for each loss. As such, this function should generally be called <strong>AFTER</strong> all of the registered loss functions have been run for the batch. Calling it before running some or all of the loss funtions could lead to unexpected results.</p>
</blockquote>
<h3 id="querying-loss-values-as-a-tensor">Querying Loss Values (as a tensor)</h3>
<p>The most recent loss tensor, which is detached and stored in the loss function's <code>LMLoss</code> every time the loss is called with <code>LossManager.compute_loss_xy()</code>, can be queried with:</p>
<pre><code class="language-python">tensors: torch.Tensor = loss_manager.get_loss_tensors()
</code></pre>
<blockquote>
<p>[!IMPORTANT]
<code>LossManager.get_loss_tensors()</code> uses the last value stored in the <code>LMLoss</code> objects <code>last_loss_map</code>. As such, this function should generally be called <strong>AFTER</strong> all of the registered loss functions have been run for the batch. Calling it before running some or all of the loss funtions could lead to unexpected results.</p>
</blockquote>
<h3 id="querying-loss-weights">Querying Loss Weights</h3>
<p>The current weight value of all registered losses can be retrieved as follows:</p>
<pre><code class="language-python">weights: dict[str, float] = loss_manager.get_loss_weights(precision=2)
</code></pre>
<p>This will return a dictionary of floating point values with lookup keys matching the corresponding loss's name. The values will represent the current weight of the loss at the time that the function was run. The optional <code>precision</code> argument tells the function how many digits after the decimal point to round the returned weight values to. The default is <code>2</code> to keep things tidy if you want to print or otherwise log the values, but you can increase it if you need more precise return values.</p>
<blockquote>
<p>[!IMPORTANT]
<code>LossManager.get_loss_weights()</code> uses the last weight value stored in <code>LossManager.schedule.current_value</code>. Since this value is updated immediately after the associated loss has been run, the weight values that this function returns are the ones which will be applied the next time the loss is run.</p>
</blockquote>
<h3 id="using-tags-to-query-registered-losses">Using Tags to Query Registered Losses</h3>
<p><strong>All of the above loss querying functions accept an optional argument called <code>query</code>,</strong> which is a list of strings. This can be used to query loss values by tag; only loss values which have a tag matching one of the strings in the input <code>query</code> argument will be returned. </p>
<p>For example, when we registered our loss function above, we assigned it a tag of <code>descriptive_lookup_tag</code>. Were we to then want to query losses with that tag, it would look something like this:</p>
<pre><code class="language-python">lossfns: dict[str, LMLoss] = loss_manager.get_registered_losses(query=['descriptive_lookup_tag'])
values : dict[str, float]  = loss_manager.get_loss_values(query=['descriptive_lookup_tag'])
tensors: dict[str, Tensor] = loss_manager.get_loss_tensors(query=['descriptive_lookup_tag'])
weights: dict[str, float]  = loss_manager.get_loss_weights(query=['descriptive_lookup_tag'])
</code></pre>
<h2 id="dumping-cached-values-to-loss-log">Dumping Cached Values to Loss Log</h2>
<blockquote>
<p>[!NOTE]
This section is only applicable if the given <code>LossManager</code> instance was intialized with <code>enable_logging=True</code>.</p>
</blockquote>
<p>When a <code>LossManager</code> instance is initialized, an optional argument can be passed called <code>history_buffer_size</code>. This value defines how many values (stored as 32bit floating point values) can be stored in <strong><em>each list</em></strong> (i.e. <code>losses</code>, <code>weights</code>) of <strong><em>each LMLoss's</em></strong> LMHistory container. By default, this is <code>50000</code>. So, with the default value, each registed loss is allowed to store 50,000 unique previous loss values and 50,000 unique previous loss weight values. 100,000 32bit floats per registered loss. This is a totally acceptable fallback value on any modern system (you could mutiply this value by 100 and still be totally safe) and this value felt fine on every dataset I tested it on, but you are also welcome to set the value higher when you initialize the <code>LossManager</code>. The Toolbox <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/toolbox/workers/pix2pix_trainerworker.py"><code>Pix2pixTrainerWorker</code></a> actually bypasses this cap altogether by always setting the buffer size to a value that is slightly higher than what would be dictated by the options selected in the UI.</p>
<p>Whenever any registered loss is run from any <code>LossManager</code> instance, the <code>LossManager</code> first does a quick check to see if the buffer for that loss is full. If it is, it will dump the loss's buffer to the log, clear the buffer, then run the loss function it was originally going to run and appends the result to the now freed up buffer. This is a fine way to handle loss logging with the <code>LossManager</code>. It is set and forget, just give it a value for the <code>history_buffer_size</code> and the <code>LossManager</code> will take care of the loss logging and memory management from there.</p>
<p>However, if you would like more control over when exactly the logs are dumped (at the end of each epoch, for example, as in the core <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/pix2pix_trainer.py"><code>Pix2pixTrainer</code></a>'s <code>on_epoch_end()</code> function. Or maybe each <code>x</code> number of epochs, as in the Toolbox <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/toolbox/workers/pix2pix_trainerworker.py"><code>Pix2pixTrainerWorker</code></a>'s <code>run()</code> function), you can instead force the <code>LossManager</code> to dump its buffers to the loss log with:</p>
<pre><code class="language-python">loss_manager.update_loss_log(silent=True, capture=False)
</code></pre>
<blockquote>
<p>[!TIP]
<code>LossManager.update_loss_log()</code> has two optional boolean arguments, <code>silent</code> (default=True) and <code>capture</code> (default=False). If <code>silent</code> is <code>False</code>, the <code>LossManager</code> will print a string to the console after it has dumped it values to the log with a timestamp showing how long it took to perform the operation. If silent is <code>False</code> and the other optional argument, <code>capture</code>, is <code>True</code> however, the string that would have been printed is instead returned by the function. </p>
</blockquote>
<h2 id="loss-specs">Loss Specs?</h2>
<p><strong>Loss specifications (specs) are a novel way to define reusable objective functions for your models. At their core, loss specs are just standard Python functions but with one specific requirement, the must return a dictionary of string-mapped <code>LMLoss</code> objects.</strong></p>
<h4 id="see-here-for-more-information-on-loss-specifications">See <a href="../loss_spec/">here</a> for more information on loss specifications</h4>
<h2 id="convenience-functions">Convenience Functions</h2>
<h4 id="the-lossmanager-includes-two-convenience-functions-for-printing-debug-values-to-the-console-during-training-these-are">The <code>LossManager</code> includes two convenience functions for printing debug values to the console during training. These are:</h4>
<h3 id="lossmanagerprint_losses"><code>LossManager.print_losses()</code></h3>
<blockquote>
<p>From: <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/losses/loss_manager.py">nectargan.losses.loss_manager.print_losses()</a></p>
</blockquote>
<pre><code>Prints (or returns) a string of all the most recent loss values.

Note: This function uses the last value stored in LossManager.history 
for each loss. As such, this function should generally be called AFTER 
all of the registered loss functions have been run for the batch. 
Calling it before running some or all of the loss funtions could lead 
to unexpected results.

By default, this function will print a string of all registered losses 
and their most recent values, tagged with epoch and iter, formatted as:

"(epoch: {e}, iters: {i}) Loss: {L_1_N}: {L_1_V} {L_2_N}: {L_2_V} ..."

Key:
    e : input epoch
    i : input iter
    L_X_N : Loss X name
    L_X_V : Loss X value
</code></pre>
<h3 id="lossmanagerprint_weights"><code>LossManager.print_weights()</code></h3>
<blockquote>
<p>From: <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/losses/loss_manager.py">nectargan.losses.loss_manager.print_weights()</a></p>
</blockquote>
<pre><code>Prints (or optionally returns) loss weight information.

Note: This function uses the last weight value stored in:
    - `LossManager.schedule.current_value`
Since this value is updated immediately after the associated loss has
been run, the weight values that this function prints (or returns) are 
the ones which will be applied the next time the loss is run.

By default, this function will print a string of all registered losses 
and their most recent weights formatted as:

"Loss weights: {L_1_N}: {L_1_W} {L_2_N}: {L_2_W} ..."

Key:
    L_X_N : Loss X name
    L_X_W : Loss X weight
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>