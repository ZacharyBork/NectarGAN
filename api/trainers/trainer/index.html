
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ZacharyBork.github.io/NectarGAN/api/trainers/trainer/">
      
      
        <link rel="prev" href="../../dataset/">
      
      
        <link rel="next" href="../building_a_trainer/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Trainer Class - NectarGAN</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nectargan-api-trainers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="NectarGAN" class="md-header__button md-logo" aria-label="NectarGAN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NectarGAN
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Trainer Class
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ZacharyBork/NectarGAN" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="NectarGAN" class="md-nav__button md-logo" aria-label="NectarGAN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NectarGAN
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ZacharyBork/NectarGAN" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install / Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing_your_installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing Your Installation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Toolbox
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Toolbox
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Quickstart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/toolbox_training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pt. 1 - Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/toolbox_testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pt. 2 - Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/toolbox_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pt. 3 - Review
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sections
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Sections
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/experiment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Review
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../toolbox/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Trainers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Trainers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Trainer Class
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Trainer Class
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-trainer-class-is-one-of-the-core-components-of-the-nectargan-api" class="md-nav__link">
    <span class="md-ellipsis">
      The Trainer class is one of the core components of the NectarGAN API.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Intro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initializing-a-trainer-subclass" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing a Trainer (subclass)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initializing a Trainer (subclass)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-docsapiconfigmd" class="md-nav__link">
    <span class="md-ellipsis">
      From docs/api/config.md
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#member-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Member Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#member-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Member Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Member Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#component-builders" class="md-nav__link">
    <span class="md-ellipsis">
      Component Builders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Training Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-loop" class="md-nav__link">
    <span class="md-ellipsis">
      Training Loop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#console-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Console Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modelexample-image-saving" class="md-nav__link">
    <span class="md-ellipsis">
      Model/Example Image Saving
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../building_a_trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building a Trainer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5_1" >
        
          
          <label class="md-nav__link" for="__nav_4_5_1" id="__nav_4_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UNet
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5_1">
            <span class="md-nav__icon md-icon"></span>
            UNet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/unet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/unet_blocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blocks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/patchgan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PatchGAN
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Losses
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Losses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../losses/lossmanager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LossManager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../losses/loss_spec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loss Specs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../losses/loss_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loss Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Scheduling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Scheduling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/schedulers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedulers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/schedule_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/schedule_dataclass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule Dataclass
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduling/integrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onnx_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ONNX Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visdom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visdom
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scripts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Links
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Links
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/ZacharyBork/NectarGAN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/ZacharyBork/NectarGAN/releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/CONTRIBUTING.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-trainer-class-is-one-of-the-core-components-of-the-nectargan-api" class="md-nav__link">
    <span class="md-ellipsis">
      The Trainer class is one of the core components of the NectarGAN API.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Intro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initializing-a-trainer-subclass" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing a Trainer (subclass)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initializing a Trainer (subclass)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-docsapiconfigmd" class="md-nav__link">
    <span class="md-ellipsis">
      From docs/api/config.md
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#member-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Member Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#member-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Member Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Member Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#component-builders" class="md-nav__link">
    <span class="md-ellipsis">
      Component Builders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Training Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-loop" class="md-nav__link">
    <span class="md-ellipsis">
      Training Loop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#console-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Console Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modelexample-image-saving" class="md-nav__link">
    <span class="md-ellipsis">
      Model/Example Image Saving
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="nectargan-api-trainers">NectarGAN API - Trainers</h1>
<blockquote>
<p><a href="../../"><em><code>NectarGAN API - Home</code></em></a></p>
</blockquote>
<h4 id="the-trainer-class-is-one-of-the-core-components-of-the-nectargan-api">The <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py"><code>Trainer</code></a> class is one of the core components of the NectarGAN API.</h4>
<h2 id="intro">Intro</h2>
<p>The NectarGAN API provides a base <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py"><code>Trainer</code></a> class which you can inherit from to create your own model-specific trainers. The base class provides a number of convenience functions to speed up the process of building and deploying new trainers. </p>
<h3 id="initializing-a-trainer-subclass">Initializing a <code>Trainer</code> (subclass)</h3>
<p>First, let's have a quick look at the base <code>Trainer</code> <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L19"><code>__init__()</code> function</a>.</p>
<p><strong>We can see that, to initialize a <code>Trainer</code>, all that is required is a config.</strong> This will be used to initialize the <code>Trainer</code>'s internal <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/config/config_manager.py"><code>ConfigManager</code></a>, which is where all config information within the <code>Trainer</code> is pulled from. But what form that init config takes is up to you. Following is an explanation of what each input type is expecting:</p>
<blockquote>
<h6 id="from-docsapiconfigmd">From <a href="../../config/"><code>docs/api/config.md</code></a></h6>
<table>
<thead>
<tr>
<th style="text-align: center;">Type</th>
<th>Behaviour</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>str</code></td>
<td>This is expecting a string with the system path to a <code>.json</code> config file. It will attempt to parse the config file and assign the values, or return various exception types if it fails depending on the reason for the failure.</td>
</tr>
<tr>
<td style="text-align: center;"><code>PathLike</code></td>
<td>The is expecting an <code>os.PathLike</code> object containing the system path to a <code>.json</code> config file. It behaves exactly as the same as <code>str</code> does.</td>
</tr>
<tr>
<td style="text-align: center;"><code>dict[str,Any]</code></td>
<td>This is expecting a pre-parsed config file (i.e. <code>with open('config.json', 'r') as f: data = json.load(f)</code>).<br><br>It will first run a key check on the input vs. the default config, and if the input passes, it will simply assign the values directly to the <code>ConfigManager</code>'s <code>raw</code> config data, then parse them into the dataclasses. This one is a little strange because it technically bypasses the JSON stuff altogether, which is actually why it exists, to allow the Toolbox to just dump <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/config/config_data.py#L148"><code>Config</code></a>-like data directly into a <code>ConfigManager</code>, rather than needing an intermediate &gt; <code>.json</code> export step.</td>
</tr>
<tr>
<td style="text-align: center;"><code>None</code></td>
<td>If <code>input_config</code> is <code>None</code> (default), the <code>ConfigManager</code> will attempt to load the <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/config/default.json">default config file</a> located at: <code>nectargan/config/default.json</code>. If it is unable to do so, it will raise an exception.</td>
</tr>
</tbody>
</table>
</blockquote>
<p><strong>However, one thing to note is that, when initializing a <code>Trainer</code>, you may also pass it a pre-constructed <code>ConfigManager</code>. In this case, the <code>Trainer</code> will just replace its internal <code>ConfigManager</code> with the one it's passed.</strong></p>
<p>When a <code>Trainer</code> subclass is initialized, the base <code>Trainer</code> class will perform a series of setup functions:
1. It will initialize a number of core member variable, all of which will be discussed in more detail below.
2. Take the input config, whatever form that might take, and use it to initialize its internal ConfigManager.
3. Extract the selected device from the config's <code>config.common.device</code> and assign it to <code>self.device</code> since it's needed so frequently.</p>
<p><strong>If the trainer was initialized with <code>quicksetup=False</code>, then the <code>Trainer</code> init function ends here.</strong> However, if <code>quicksetup=True</code> (default), the <code>Trainer</code> init performs a few extra convenience steps. This will be expanded upon in a later section but, generally speaking, a <code>Trainer</code> will almost always be initialized with <code>quicksetup=True</code>. For now, though, these are the additional steps taken if <code>quicksetup=True</code>:</p>
<ol>
<li>The <code>Trainer</code> will build an output directory for the current experiment based on the output and experiment settings in the config. Or if <code>continue_train</code> is <code>True</code> in the <code>config</code> it was passed, it will instead just overwrite its <code>self.experiment_dir</code> with the path to the selected experiment to continue.</li>
<li>It will then initialize a <a href="../../losses/lossmanager/"><code>LossManager</code></a> to manage all of the losses during training.</li>
<li>After that, it will export a copy of its current config to the experiment directory.</li>
<li>Then it will check the input <code>config</code> to see if <code>enable_visdom</code> is <code>True</code>. If it is, it will run <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L149"><code>init_visdom()</code></a> to build and start a Visdom client. See <a href="../../visdom/">here</a> for more information.</li>
</ol>
<h2 id="member-variables">Member Variables</h2>
<p><strong>The base <code>Trainer</code> class has a few important member variables to be aware of, some of which are expected to be set by the class's which inherit from it.</strong> Here is each, with a short description:
| Variable | Description |
| :---: | --- |
<code>self.log_losses</code> | This is a boolean variable which is set based on the value of the <code>log_losses</code> input argument in <code>Trainer.__init__()</code>. It defines whether losses run in the context of the given <code>Trainer</code> instance should be cached and occasionally dumped to the loss log (see <a href="../../losses/lossmanager/">here</a> for more info).
<code>self.current_epoch</code> | An integer value which keeps track of the current epoch. At init, this is <code>None</code>. Then, each time the <code>Trainer</code>'s <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L353"><code>train_paired()</code></a> function is called, the value which is passed for the <code>epoch</code> argument first has <code>1</code> added to it, then it is assigned to <code>self.current_epoch</code>. This <code>+1</code> operation is just so that you can pass the raw iter variable from the training loop, and still have the first epoch be called <code>Epoch 1</code> everywhere where that would be relevant, like strings printed to the console for example.
<code>self.last_epoch_time</code> | A floating point variable used to keep track of the time each epoch takes. The time is checked at the beginning and end of each epoch (in <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L353"><code>Trainer.train_paired()</code></a>), then the start is subtracted from the end and the results is assigned to this variable.
<code>self.train_loader</code> | A <code>torch.utils.data.DataLoader</code> representing the training dataset. This is expected to be set by the <code>Trainer</code> subclass, although the base <code>Trainer</code> class provides a utility function to perform the heavy lifting. See <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/pix2pix_trainer.py#L109">here</a> and <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L217">here</a> for more info.
<code>self.val_loader</code> | Exactly the same as <code>self.train_loader</code>, but for the validation dataset.</p>
<h2 id="member-functions">Member Functions</h2>
<p>What follows is an exhaustive list of all of the member functions of the <code>Trainer</code> class, broken down by category. A brief description of each will be provided. For a more complete decription, please see the docstring for the given function, which can be accessed here by clicking on the function name.</p>
<h3 id="initialization-functions">Initialization Functions</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L68"><code>init_config</code></a></td>
<td>Initializes the <code>Trainer</code>'s internal <code>ConfigManager</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L91"><code>build_output_directory</code></a></td>
<td>Builds and experiment output directory based on the current config settings (or assigns the current experiment directory to <code>self.experiment_dir</code> if continuing a train on an existing model).</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L138"><code>export_config</code></a></td>
<td>Exports a copy of the <code>Trainer</code>'s current config to a <code>.json</code> file in the experiment directory.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L149"><code>init_visdom</code></a></td>
<td>Initializes a Visdom client for the training session.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L159"><code>load_checkpoint</code></a></td>
<td>Initializes a given network and optimizer with pre-trained weights from a checkpoint file contained within the current experiment directory.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L57"><code>quicksetup</code></a></td>
<td>Performs a sequence of other init functions to quickly set up all infrastructure needed for training.</td>
</tr>
</tbody>
</table>
<h3 id="component-builders">Component Builders</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L196"><code>init_loss_manager</code></a></td>
<td>Initializes a <code>LossManager</code> to manage losses for the <code>Trainer</code> during training.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L217"><code>build_dataloader</code></a></td>
<td>Initializes a <code>torch.utils.data.DataLoader</code> from a <a href="../../dataset/"><code>PairedDataset</code></a> based on settings in the <code>Trainer</code>'s current config.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L243"><code>build_optimizer</code></a></td>
<td>Simple helper function initialize an optimizer for a given network.</td>
</tr>
</tbody>
</table>
<h3 id="training-callbacks">Training Callbacks</h3>
<p><strong><em>Training callbacks are a core feature of training with the NectarGAN API. They are exremely flexible override methods that allow you to define complex training loops for your custom <code>Trainer</code> class with just a few simple function. See <a href="../building_a_trainer/">here</a> for more information.</em></strong>
| Function | Description |
| :---: | --- |
<a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L262"><code>on_epoch_start</code></a> | Run at the very beginning of an epoch in <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L353"><code>Trainer.train_paired()</code></a>, before the training loop begins.
<a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L282"><code>train_step</code></a> | Run once per batch in <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L353"><code>Trainer.train_paired()</code></a> -&gt; <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L337"><code>Trainer._train_paired_core()</code></a>.
<a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L313"><code>on_epoch_end</code></a> | Run at the very end of an epoch in <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L353"><code>Trainer.train_paired()</code></a>, after all the batches for the epoch have been completed.</p>
<h3 id="training-loop">Training Loop</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L337"><code>_train_paired_core</code></a></td>
<td>The core <code>Trainer</code> paired training loop, called by <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L353"><code>Trainer.train_paired()</code></a> after it has completed it's epoch init steps and run the <code>on_epoch_start</code> callback.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L353"><code>train_paired</code></a></td>
<td><strong>This is the core paired adversarial training function.</strong> It largely serves as a public wrapper around <code>_train_paired_core</code>, however, it also performs some additional epoch init steps and runs the <code>on_train_start</code> callback before the main loop, and the <code>on_train_end</code> callback after it is complete.</td>
</tr>
</tbody>
</table>
<h3 id="console-logging">Console Logging</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L428"><code>print_end_of_epoch</code></a></td>
<td>A function, meant to be run at the end of each epoch, which will print the time that the epoch took to complete to the console. The <code>Pix2pixTrainer</code> also <a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/pix2pix_trainer.py#L197">extends this function</a> to print a couple extra lines related to learning rate changes for G and D.</td>
</tr>
</tbody>
</table>
<h3 id="modelexample-image-saving">Model/Example Image Saving</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L443"><code>export_model_weights</code></a></td>
<td>A utility function which will take a network and its associated optimizer, and save a checkpoint for the network as a <code>.pth.tar</code> to the current experiment directory, tagged with the current epoch value at the time the function was called.</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/ZacharyBork/NectarGAN/blob/main/nectargan/trainers/trainer.py#L476"><code>save_xyz_examples</code></a></td>
<td>This function will swap a given network over into eval mode, select a random set of images from the <code>self.val_loader</code> dataset (the number of images is defined by the value of ['config']['save']['num_examples'] in the config file), run the network's inference on each image, and for each image, export 3 <code>.png</code> files to the current experient directory's example subdirectory. Then it switches the network back in to train mode.</td>
</tr>
<tr>
<td style="text-align: center;">## Building a New Trainer</td>
<td></td>
</tr>
<tr>
<td style="text-align: center;"><strong>The base <code>Trainer</code> class can be easily inherited from to create new <code>Trainer</code> subclasses for additional models.</strong></td>
<td></td>
</tr>
</tbody>
</table>
<p><em>See <a href="../building_a_trainer/">here</a> for more information.</em></p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>